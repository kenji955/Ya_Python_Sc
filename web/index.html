<html>
  <head>
    <title>ebay出品ツール_楽天</title>
    <link rel="stylesheet" href="./style.css" />
  </head>
  <body>
    抽出対象選択<br />
    <input type="radio" name="output_style" value="商品一覧" checked>商品一覧
    <input type="radio" name="output_style" value="出品リスト">出品リスト<br />
    <input type="checkbox" name="kataban" value="1">型番のみの抽出を行う<br />
    都道府県名：<input type="search" id="Todofuken_name" placeholder="都道府県" value="石川県" /><br />
    商品一覧URL：<input type="search" id="url" value="https://auctions.yahoo.co.jp/search/search?va=%E3%82%AE%E3%82%BF%E3%83%BC&istatus=2&exflg=1&b=1&n=100&s1=new&o1=d&auccat=&tab_ex=commerce&ei=utf-8&aq=-1&oq=&sc_i=&exflg=1&p=%E3%82%AE%E3%82%BF%E3%83%BC&x=16&y=22"/><br />
    ページ数(,区切り)：<input type="search" id="page" value="1,1"/><br />
    商品名に追加するワード(,区切り)：<input type="search" id="add_word" value="testBefore,testAfter"/><br />
    削除するワードのファイル(翻訳前)：<input type="search" id="delete_word_before" value="delete_word_before.csv"/><br />
    削除するワードのファイル(翻訳後)：<input type="search" id="delete_word_after" value="delete_word_after.csv"/><br />
    補充するワードのファイル名：<input type="search" id="fill_in_word" value="fill_in_word.csv"/><br />
    作成するファイル名：<input type="search" id="file_name" value=".xlsx"/><br />
    <button id="button">実行</button><br />
    <b><textarea id="textarea" rows="20" cols="50"></textarea></b>

    <script type="text/javascript" src="./eel.js"></script>
    <script>
      button.addEventListener("click", () => {
        let url = document.getElementById("url").value.trim();
        let page = document.getElementById("page").value.trim();
        let add_word = document.getElementById("add_word").value.trim();
        let delete_word_before = document.getElementById("delete_word_before").value.trim();
        let delete_word_after = document.getElementById("delete_word_after").value.trim();
        let fill_in_word = document.getElementById("fill_in_word").value.trim();
        let file_name = document.getElementById("file_name").value.trim();

        if (
          !url ||
          !page ||
          !add_word ||
          !delete_word_before ||
          !delete_word_after ||
          !fill_in_word ||
          !file_name
        ) {
          alert("入力していない項目があります");
        } else {
          document.getElementById("textarea").value = "実行しました\n\n";
          eel.main();
        }
      });

      eel.expose(url);
      function url() {
        return document.getElementById("url").value.trim();
      }

      eel.expose(page);
      function page() {
        return document.getElementById("page").value.trim();
      }

      eel.expose(add_word);
      function add_word() {
        return document.getElementById("add_word").value.trim();
      }

      eel.expose(delete_word_before);
      function delete_word_before() {
        return document.getElementById("delete_word_before").value.trim();
      }

      eel.expose(delete_word_after);
      function delete_word_after() {
        return document.getElementById("delete_word_after").value.trim();
      }

      eel.expose(fill_in_word);
      function fill_in_word() {
        return document.getElementById("fill_in_word").value.trim();
      }

      eel.expose(file_name);
      function file_name() {
        return document.getElementById("file_name").value.trim();
      }

      eel.expose(view_log_js);
      function view_log_js(text) {
        document.getElementById("textarea").value += text + "\n";
      }

      eel.expose(Todofuken_name);
      function Todofuken_name() {
        return document.getElementById("Todofuken_name").value.trim();
      }
      
      eel.expose(output_check);
      function output_check(){
        elements = document.getElementsByName("output_style");
        for(let i = 0; i<elements.length; i++){
	        if(elements[i].checked){
		        return elements[i].value;
		        break;
	        }
        }
      }
      

    </script>
  </body>
</html>
